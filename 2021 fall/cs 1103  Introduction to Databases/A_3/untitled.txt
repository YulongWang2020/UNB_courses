SELECT COUNT(*) AS NUMBER_OF_INVOICES
FROM INVOICE;

SELECT COUNT(*) AS NUMBER_OF_CUSTOMERS 
	FROM CUSTOMER 
	WHERE CUS_BALANCE > 500;

SELECT A.CUS_CODE, 
	B.INV_NUMBER, 
	D.P_DESCRIPT, 
	ROUND(C.LINE_UNIT,0) AS 'Units Bought', 
	C.LINE_PRICE AS 'Unit Price', 
	ROUND(C.LINE_UNIT*C.LINE_PRICE,2) AS Subtotal 
FROM CUSTOMER AS A
JOIN INVOICE AS B ON A.CUS_CODE = B.CUS_CODE
JOIN LINE AS C ON B.INV_NUMBER = C.INV_NUMBER
JOIN PRODUCT AS D ON C.P_CODE = D.P_CODE;

SELECT A.CUS_CODE,
	A.CUS_BALANCE, 
	ROUND(SUM(C.LINE_UNIT*C.LINE_PRICE),2) AS 'Total Purchases',
	COUNT(*) AS 'Number of Purchases',
	ROUND(SUM(C.LINE_UNIT*C.LINE_PRICE)/COUNT(*),2) AS 'Average Purchases Amount'
FROM CUSTOMER AS A
JOIN INVOICE AS B ON A.CUS_CODE = B.CUS_CODE
JOIN LINE AS C ON B.INV_NUMBER = C.INV_NUMBER
JOIN PRODUCT AS D ON C.P_CODE = D.P_CODE
GROUP BY A.CUS_CODE;

SELECT A.CUS_CODE, A.CUS_BALANCE
	FROM CUSTOMER AS A
	LEFT JOIN INVOICE AS B ON A.CUS_CODE = B.CUS_CODE
	WHERE B.INV_NUMBER IS NULL;

SELECT *
	FROM LGDEPARTMENT
	ORDER BY DEPT_NAME;

SELECT PROD_SKU, PROD_DESCRIPT, PROD_TYPE, PROD_BASE,  PROD_CATEGORY, PROD_PRICE
	FROM LGPRODUCT
	WHERE PROD_BASE = 'Water' AND PROD_CATEGORY = 'Sealer';

SELECT DISTINCT CUST_FNAME, CUST_LNAME, CUST_STREET, CUST_CITY, CUST_STATE, CUST_ZIP
	FROM LGCUSTOMER AS A
	JOIN LGINVOICE AS B ON A.CUST_CODE = B.CUST_CODE
	JOIN LGLINE AS C ON B.INV_NUM = C.INV_NUM
	JOIN LGPRODUCT AS D ON C.PROD_SKU = D.PROD_SKU
	JOIN LGBRAND AS E ON D.BRAND_ID = E.BRAND_ID
	WHERE E.BRAND_NAME = 'FORESTERS BEST' AND D.PROD_CATEGORY = 'Top Coat' AND (B.INV_DATE BETWEEN '2017-07-15' AND'2017-07-31')
	ORDER BY CUST_STATE, CUST_LNAME, CUST_FNAME;
